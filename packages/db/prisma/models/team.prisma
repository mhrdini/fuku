model Team {
  id          String  @id @default(uuid())
  slug        String  @unique
  name        String  @unique
  description String?

  teamMembers     TeamMember[]
  adminUsers      User[]       @relation("UserTeams")
  payGrades       PayGrade[]
  locations       Location[]
  shiftTypes      ShiftType[]
  lastActiveUsers User[]       @relation("LastActiveTeamUsers")

  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @default(now()) @updatedAt @map("updated_at")
  deletedAt   DateTime? @map("deleted_at")
  deletedById String?   @map("deleted_by_id")

  @@index([deletedAt])
  @@map("team")
}

model PayGrade {
  id          String  @id @default(uuid())
  name        String
  description String?
  baseRate    Float   @map("base_rate")

  teamId      String
  team        Team         @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  teamMembers TeamMember[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@unique([teamId, name])
  @@map("pay_grade")
}

enum TeamMemberRole {
  ADMIN
  STAFF
}

model TeamMember {
  id     String  @id @default(uuid())
  userId String? @map("user_id")
  user   User?   @relation("UserMemberships", fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  familyName String @map("family_name")
  givenNames String @map("given_names")

  teamId String
  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  payGradeId String?   @map("pay_grade_id")
  payGrade   PayGrade? @relation(fields: [payGradeId], references: [id], onDelete: Restrict, onUpdate: Cascade)

  teamMemberRole TeamMemberRole @default(STAFF) @map("team_member_role")

  rateMultiplier Float @default(1.0) @map("rate_multiplier")

  dayAssignments   DayAssignment[]
  unavailabilities Unavailability[]
  color            String           @default("#000000")

  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @default(now()) @updatedAt @map("updated_at")
  deletedAt   DateTime? @map("deleted_at")
  deletedById String?   @map("deleted_by_id")

  @@index([teamId])
  @@index([payGradeId])
  @@index([deletedAt])
  @@map("team_member")
}
